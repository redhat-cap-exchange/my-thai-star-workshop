FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBjbG91ZC1uYXRpdmUtd29ya3Nob3AtYXBiCmRlc2NyaXB0\
aW9uOiBBUEIgdG8gZGVwbG95IHJlcXVpcmVkIGluZnJhIGNvbXBvbmVudHMgZm9yIFJvYWQtdG8t\
Q2xvdWQtTmF0aXZlIFdvcmtzaG9wcyBvbiBhbiBPcGVuU2hpZnQgY2x1c3RlcgpiaW5kYWJsZTog\
RmFsc2UKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6Ci0gd29ya3Nob3AKLSBjbG91ZC1uYXRpdmUKbWV0\
YWRhdGE6CiAgZGVwZW5kZW5jaWVzOiBbXQogIGRpc3BsYXlOYW1lOiAiUm9hZC10by1DbG91ZC1O\
YXRpdmUgV29ya3Nob3AgKENvZGVSZWFkeSkgSW5zdGFsbGVyIgogIGxvbmdEZXNjcmlwdGlvbjog\
IlJlcXVpcmVkIGNvbXBvbmVudHMgKENvZGVSZWFkeSBXb3Jrc3BhY2VzLCBOZXh1cywgR3VpZGVz\
IGV0YykiCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiAicGZpY29uIHBmaWNvbi1z\
ZXJ2aWNlcyIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAg\
LSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95\
cyByb2FkLXRvLWNsb3VkLW5hdGl2ZS13b3Jrc2hvcAogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRh\
dGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBvcGVuc2hpZnRfdXNlcgogICAgICB0\
aXRsZTogVXNlcm5hbWUKICAgICAgZGVzY3JpcHRpb246IFVzZXIgaXMgcmVxdWlyZWQgZm9yIGNy\
ZWF0aW5nIHByb2plY3QgYWRtaW4gcmVzb3VyY2VzCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICBkaXNwbGF5X2dyb3VwOiBPcGVuU2hpZnQgTWFzdGVyCiAgICAt\
IG5hbWU6IG9wZW5zaGlmdF9wYXNzd29yZAogICAgICB0aXRsZTogUGFzc3dvcmQKICAgICAgZGVz\
Y3JpcHRpb246IFBhc3N3b3JkIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFkbWlu\
IHJlc291cmNlcwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICBkaXNwbGF5X2dyb3VwOiBPcGVuU2hpZnQgTWFz\
dGVyCiAgICAtIG5hbWU6IHVzZXJfY291bnQKICAgICAgdGl0bGU6IE51bWJlciBvZiBQYXJ0aWNp\
cGFudHMKICAgICAgZGVzY3JpcHRpb246IFRoZSBudW1iZXIgb2YgcGFydGljaXBhbnRzCiAgICAg\
IHR5cGU6IG51bWJlcgogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBkZWZhdWx0OiAxMAogICAg\
ICBkaXNwbGF5X3R5cGU6IG51bWJlcgogICAgICBkaXNwbGF5X2dyb3VwOiBMYWJzICYgR3VpZGVz\
CiAgICAtIG5hbWU6IG9wZW5zaGlmdF9tYXN0ZXJfdXJsCiAgICAgIHRpdGxlOiBPcGVuU2hpZnQg\
TWFzdGVyIFVSTAogICAgICBkZXNjcmlwdGlvbjogVGhlIGFkZHJlc3MgdG8gT3BlblNoaWZ0IG1h\
c3RlciBVUkwgdG8gYmUgZGlzcGxheWVkIGluIHRoZSBsYWIgZ3VpZGUgdG8gcGFydGljaXBhbnRz\
CiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBkaXNwbGF5X3R5\
cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBMYWJzICYgR3VpZGVzCiAgICAtIG5hbWU6\
IG9wZW5zaGlmdF91c2VyX3Bhc3N3b3JkCiAgICAgIHRpdGxlOiBPcGVuU2hpZnQgVXNlciBQYXNz\
d29yZAogICAgICBkZXNjcmlwdGlvbjogVGhlIE9wZW5TaGlmdCBwYXNzd29yZCBmb3IgcGFydGlj\
aXBhbnRzIHRvIGJlIGRpc3BsYXllZCBpbiB0aGUgbGFiIGd1aWRlIHRvIHBhcnRpY2lwYW50cwog\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogIm9wZW5zaGlmdCIKICAgICAgcmVxdWly\
ZWQ6IHRydWUKICAgICAgZGlzcGxheV90eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91cDog\
TGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBnaXRfcmVwb3NpdG9yeV9ndWlkZV9wYXRoCiAgICAg\
IHRpdGxlOiBHaXQgUmVwb3NpdG9yeSBHdWlkZSBQYXRoCiAgICAgIGRlc2NyaXB0aW9uOiBUaGUg\
UGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aXRoIHRoZSBsYWIgZ3VpZGUgZm9yIHBhcnRpY2lwYW50\
cyA8Z2l0aHViX2FjY291bnQ+LzxnaXRodWJfcHJvamVjdD4KICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIGRlZmF1bHQ6ICJyZWRoYXQtY2FwZ2VtaW5pLWV4Y2hhbmdlL215LXRoYWktc3Rhci1ndWlk\
ZXMiCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRpc3BsYXlfdHlwZTogc3RyaW5nCiAgICAg\
IGRpc3BsYXlfZ3JvdXA6IExhYnMgJiBHdWlkZXMKICAgIC0gbmFtZTogZ2l0X3JlcG9zaXRvcnlf\
Z3VpZGVfcmVmZXJlbmNlCiAgICAgIHRpdGxlOiBHaXQgUmVwb3NpdG9yeSBHdWlkZSBSZWZlcmVu\
Y2UKICAgICAgZGVzY3JpcHRpb246IFNldCB0aGlzIHRvIGEgYnJhbmNoIG5hbWUsIHRhZyBvciBv\
dGhlciByZWYgb2YgeW91ciByZXBvc2l0b3J5IGlmIHlvdSBhcmUgbm90IHVzaW5nIHRoZSBkZWZh\
dWx0IGJyYW5jaC4KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6ICJtYXN0ZXIiCiAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRpc3BsYXlfdHlwZTogc3RyaW5nCiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IExhYnMgJiBHdWlkZXMKICAgIC0gbmFtZTogZ3VpZGVfbmFtZQogICAgICB0aXRs\
ZTogR3VpZGUgTmFtZQogICAgICBkZXNjcmlwdGlvbjogU2V0IHRoZSBuYW1lIG9mIHRoZSBndWlk\
ZSBmb3IgX3JvYWQtdG8tY2xvdWQtbmF0aXZlLXdvcmtzaG9wLTxndWlkZV9uYW1lPi55bWwKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6ICJjb2RlcmVhZHkiCiAgICAgIHJlcXVpcmVk\
OiB0cnVlCiAgICAgIGRpc3BsYXlfdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3JvdXA6IExh\
YnMgJiBHdWlkZXMKICAgIC0gbmFtZTogZ2l0X3JlcG9zaXRvcnlfbGFiX3BhdGgKICAgICAgdGl0\
bGU6IEdpdCBSZXBvc2l0b3J5IExhYiBQYXRoCiAgICAgIGRlc2NyaXB0aW9uOiBUaGUgUGF0aCBv\
ZiB0aGUgcmVwb3NpdG9yeSB3aXRoIHRoZSBsYWIgZm9yIHBhcnRpY2lwYW50cyA8Z2l0aHViX2Fj\
Y291bnQ+LzxnaXRodWJfcHJvamVjdD4KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6\
ICJyZWRoYXQtY2FwZ2VtaW5pLWV4Y2hhbmdlL215LXRoYWktc3Rhci13b3Jrc2hvcCIKICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxheV90eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9n\
cm91cDogTGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBnaXRfcmVwb3NpdG9yeV9sYWJfcmVmZXJl\
bmNlCiAgICAgIHRpdGxlOiBHaXQgUmVwb3NpdG9yeSBMYWIgUmVmZXJlbmNlCiAgICAgIGRlc2Ny\
aXB0aW9uOiBTZXQgdGhpcyB0byBhIGJyYW5jaCBuYW1lLCB0YWcgb3Igb3RoZXIgcmVmIG9mIHlv\
dXIgcmVwb3NpdG9yeSBpZiB5b3UgYXJlIG5vdCB1c2luZyB0aGUgZGVmYXVsdCBicmFuY2guCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiAibWFzdGVyIgogICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICBkaXNwbGF5X3R5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBMYWJz\
ICYgR3VpZGVzCiAgICAtIG5hbWU6IGluZnJhc3Zjc19hZG1fdXNlcgogICAgICB0aXRsZTogSW5m\
cmEgU2VydmljZXMgQWRtaW4gVXNlcgogICAgICBkZXNjcmlwdGlvbjogQWRtaW4gdXNlciBmb3Ig\
aW5mcmFzdHJ1Y3R1cmUgc2VydmljZXMgKEdvZ3MsIE5leHVzLCAuLi4pCiAgICAgIHR5cGU6IHN0\
cmluZwogICAgICBkZWZhdWx0OiAiYWRtaW51c2VyIgogICAgICByZXF1aXJlZDogdHJ1ZQogICAg\
ICBkaXNwbGF5X3R5cGU6IHRleHQKICAgICAgZGlzcGxheV9ncm91cDogV29ya3Nob3AgSW5mcmEg\
U2VydmljZXMKICAgIC0gbmFtZTogaW5mcmFzdmNzX2FkbV9wd2QKICAgICAgdGl0bGU6IEluZnJh\
IFNlcnZpY2VzIEFkbWluIFBhc3N3b3JkCiAgICAgIGRlc2NyaXB0aW9uOiBBZG1pbiBwYXNzd29y\
ZCBmb3IgaW5mcmFzdHJ1Y3R1cmUgc2VydmljZXMgKEdvZ3MsIE5leHVzLCAuLi4pCiAgICAgIHR5\
cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiAiYWRtaW5wd2QiCiAgICAgIHJlcXVpcmVkOiB0cnVl\
CiAgICAgIGRpc3BsYXlfdHlwZTogdGV4dAogICAgICBkaXNwbGF5X2dyb3VwOiBXb3Jrc2hvcCBJ\
bmZyYSBTZXJ2aWNlcwogICAgICA="


COPY playbooks /opt/apb/project
ADD requirements.yml /opt/apb/project/requirements.yml
RUN ansible-galaxy install -r /opt/apb/project/requirements.yml -f
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
